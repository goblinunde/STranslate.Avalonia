<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:STranslate.Avalonia.ViewModels"
        xmlns:controls="using:STranslate.Avalonia.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="470" d:DesignHeight="600"
        x:Class="STranslate.Avalonia.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="STranslate"
        Width="470"
        MinWidth="400"
        MinHeight="200"
        ShowInTaskbar="False"
        Topmost="{Binding IsTopmost}"
        WindowStartupLocation="Manual"
        Icon="/Assets/app.ico">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <!-- ðŸ’¡ Avalonia ä½¿ç”¨ KeyBindings ä»£æ›¿ InputBindings -->
    <Window.KeyBindings>
        <KeyBinding Gesture="Escape" Command="{Binding CancelCommand}"/>
        <KeyBinding Gesture="Ctrl+Shift+Q" Command="{Binding ExitCommand}"/>
    </Window.KeyBindings>

    <Grid>
        <!-- ðŸ’¡ é¡¶éƒ¨å·¥å…·æ  -->
        <controls:HeaderControl
            Padding="6,4,6,0"
            VerticalAlignment="Top"
            IsTopmost="{Binding IsTopmost}"
            SettingCommand="{Binding OpenSettingsCommand}"
            HistoryPreviousCommand="{Binding HistoryPreviousCommand}"
            HistoryNextCommand="{Binding HistoryNextCommand}"
            ColorSchemeCommand="{Binding ChangeColorSchemeCommand}"
            IsHideInput="{Binding IsHideInput}"
            IsMouseHook="{Binding IsMouseHook}"
            ScreenshotTranslateCommand="{Binding ScreenshotTranslateCommand}"
            OcrCommand="{Binding OcrCommand}"
            IsAutoTranslate="{Binding IsAutoTranslate}"/>

        <!-- ðŸ’¡ ä¸»å†…å®¹åŒºåŸŸ -->
        <ScrollViewer Margin="10,40,0,5">
            <StackPanel>
                <!-- ðŸ’¡ è¾“å…¥æŽ§ä»¶ -->
                <controls:InputControl
                    x:Name="PART_Input"
                    Margin="0,0,10,10"
                    Text="{Binding InputText, Mode=TwoWay}"
                    IdentifiedLanguage="{Binding IdentifiedLanguage}"
                    IsIdentify="{Binding IsIdentifyProcessing}"
                    CurrentFontSize="{Binding Settings.FontSize}"
                    ExecuteCommand="{Binding TranslateCommand}"
                    ForceExecuteCommand="{Binding TranslateCommand}"
                    SaveToVocabularyCommand="{Binding SaveToVocabularyCommand}"
                    HasActivedVocabulary="{Binding VocabularyService.HasActivedVocabulary}"
                    PlayAudioCommand="{Binding PlayAudioCommand}"
                    CopyCommand="{Binding CopyCommand}"
                    RemoveLineBreaksCommand="{Binding RemoveLineBreaksCommand}"
                    RemoveSpacesCommand="{Binding RemoveSpacesCommand}"
                    TranslateOnPaste="{Binding Settings.TranslateOnPaste}"/>

                <!-- ðŸ’¡ ç¿»è¯‘æŒ‰é’® -->
                <Button 
                    Content="ç¿»è¯‘"
                    Command="{Binding TranslateCommand}"
                    HorizontalAlignment="Center"
                    Padding="40,10"
                    Margin="0,10"
                    FontSize="16"
                    FontWeight="Bold"
                    Classes="accent" />

                <!-- ðŸ’¡ è¯­è¨€é€‰æ‹©åŒºåŸŸ -->
                <Grid Margin="0,0,10,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- æºè¯­è¨€ -->
                    <ComboBox Grid.Column="0"
                              HorizontalAlignment="Stretch"
                              SelectedIndex="0">
                        <ComboBoxItem Content="è‡ªåŠ¨æ£€æµ‹"/>
                        <ComboBoxItem Content="ä¸­æ–‡"/>
                        <ComboBoxItem Content="è‹±è¯­"/>
                        <ComboBoxItem Content="æ—¥è¯­"/>
                    </ComboBox>

                    <!-- äº¤æ¢æŒ‰é’® -->
                    <Button Grid.Column="1"
                            Margin="10,0"
                            Content="â‡†"
                            ToolTip.Tip="äº¤æ¢è¯­è¨€"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Command="{Binding SwapLanguageCommand}"/>

                    <!-- ç›®æ ‡è¯­è¨€ -->
                    <ComboBox Grid.Column="2"
                              HorizontalAlignment="Stretch"
                              SelectedIndex="1">
                        <ComboBoxItem Content="ä¸­æ–‡"/>
                        <ComboBoxItem Content="è‹±è¯­"/>
                        <ComboBoxItem Content="æ—¥è¯­"/>
                    </ComboBox>
                </Grid>

                <!-- ðŸ’¡ ç¿»è¯‘ç»“æžœè¾“å‡º (ç®€åŒ–ç‰ˆ) -->
                <Border Margin="0,0,10,0"
                        Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12">
                    <StackPanel Spacing="10">
                        <!-- æ ‡é¢˜æ  -->
                        <DockPanel>
                            <TextBlock Text="ç¿»è¯‘ç»“æžœ" 
                                      FontWeight="Bold" 
                                      FontSize="14"
                                      DockPanel.Dock="Left"/>
                            <StackPanel DockPanel.Dock="Right" 
                                       Orientation="Horizontal" 
                                       Spacing="4"
                                       HorizontalAlignment="Right">
                                <controls:IconButton
                                    Icon="ðŸ”Š"
                                    ToolTip.Tip="æ’­æ”¾è¯­éŸ³"
                                    Command="{Binding PlayAudioCommand}"/>
                                <controls:IconButton
                                    Icon="ðŸ“‹"
                                    ToolTip.Tip="å¤åˆ¶"
                                    Command="{Binding CopyCommand}"/>
                            </StackPanel>
                        </DockPanel>

                        <!-- ç¿»è¯‘ç»“æžœæ–‡æœ¬ -->
                        <TextBox Text="{Binding OutputText, Mode=TwoWay}"
                                IsReadOnly="True"
                                Background="Transparent"
                                BorderThickness="0"
                                TextWrapping="Wrap"
                                MinHeight="100"
                                FontSize="14"
                                Watermark="ç¿»è¯‘ç»“æžœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
